function consumeBootstrap(a){app.data={systems:new app.Collections.Systems,games:new app.Collections.Games},app.data.systems.add(a.systems),app.data.games.add(a.games)}this.TPL=this.TPL||{},this.TPL["game-row"]=function(obj){function extras(a){var b={has_case:'<span title="Has Case" class="glyphicon glyphicon-ok"></span>',has_docs:'<span title="Has Docs" class="glyphicon glyphicon-book"></span>',is_ghit:'<span title="Greatest hits edition" class="glyphicon glyphicon-star-empty"></span>',is_limited:'<span title="Limited Edition!" class="glyphicon glyphicon-fire"></span>',is_complete:'<span title="Is Compelte" class="glyphicon glyphicon-heart"></span>',is_broken:'<span title="Is Broken" class="glyphicon glyphicon-remove"></span>'},c="";return _.each(b,function(d,e){1==a[e]&&(c+=b[e])}),c}obj||(obj={});{var __t,__p="";_.escape,Array.prototype.join}with(obj)__p+='\n<div class="col-sm-3">'+(null==(__t=name)?"":__t)+'</div>\n<div class="col-sm-2">'+(null==(__t=release)?"":__t)+" "+(null==(__t=extras(obj))?"":__t)+' </div>\n<div class="col-sm-7">\n	<button type="button" class="btn btn-default btn-sm">\n		<span class="glyphicon glyphicon-star"></span> Edit\n	</button>\n	'+(null==(__t=comment)?"":__t)+"\n</div>\n\n";return __p},this.TPL["system-edit"]=function(obj){function companyDropdown(a){var b=app.data.systems.pluck("company");b=_.unique(b),b=_.sortBy(b);var c=_.reduce(b,function(b,c){var d="";return c==a&&(d=" selected='selected'"),b+="<option"+d+">"+c+"</option>"},"");return"<select name='company' class='form-control'>"+c+"</select>"}obj||(obj={});{var __t,__p="",__e=_.escape;Array.prototype.join}with(obj)__p+='\n<div class="row">\n  <div class="col-sm-6 col-xs-12">\n    <form method="post" action="/system" class="form-edit-system" role="form">\n      <div class="form-group">\n	<label>Company\n	  '+(null==(__t=companyDropdown(company))?"":__t)+'\n	</label>\n	<br>\n	<label>Or, new:\n	  <input type="text" name="new_company" class="form-control">\n	</label>\n      </div>\n      <div class="form-group">\n	<label>System Name\n	  <input type="text" name="name" class="form-control" value="'+__e(name)+'">\n	</label>\n      </div>\n      <div class="form-group">\n	<label>Release\n	  <input type="text" name="release" class="form-control" value="'+__e(release)+'">\n	</label>\n      </div>\n      <div class="form-group">\n	<label for="comments">Comments</label>\n	<textarea name="comments" class="form-control">'+__e(comments)+'</textarea>\n      </div>\n      <div class="form-group">\n	<button type="submit" value="Edit System" class="btn btn-default">\n	  <i class="glyphicon glyphicon-floppy-disk"></i> Save Changes\n	</button>\n      </div>\n    </form>\n  </div>\n</div>\n';return __p},this.TPL["system-row"]=function(obj){obj||(obj={});{var __p="",__e=_.escape;Array.prototype.join}with(obj)__p+='\n<div class="row">\n  <div class="col-sm-8">\n    <button type="button" class="btn btn-default btn-sm edit">\n      <span class="glyphicon glyphicon-star"></span> Edit\n    </button>\n    <strong>'+__e(company)+" "+__e(name)+'</strong>\n  </div>\n  <div class="col-sm-4">'+__e(release)+'</div>\n</div>\n<div class="row">\n  <div class="col-sm-11 col-sm-offset-1">'+__e(comments)+"</div>\n</div>\n\n";return __p};var app=new Marionette.Application;app.addInitializer(function(){console.log("APP has started")}),app.Collections={Systems:Backbone.Collection.extend({url:"/systems",comparator:"release"}),Games:Backbone.Collection.extend({url:"/games"})},app.on("initialize:before",function(){console.log("Consuming bootstraped data"),consumeBootstrap(window.__bootstrap)}),app.config={dateFormat:"MMMM Do YYYY"},app.module("Games",function(a,b){a.addInitializer(function(){console.log("INIT: games module"),c=new d.GameList({collection:b.data.games}),c.render(),$("#game-list").empty().append(c.el)});var c,d={};d.GameRow=Marionette.ItemView.extend({template:window.TPL["game-row"],tagName:"div",className:"row game-row"}),d.GameList=Marionette.CollectionView.extend({tagName:"div",className:"container-fluid",itemView:d.GameRow})}),app.module("Systems",function(a,b){a.addInitializer(function(){console.log("INIT: Systems module"),c=new d.SystemList({collection:b.data.systems}),c.render(),$("#system-list").empty().append(c.el)});var c,d={};d.SystemRow=Marionette.ItemView.extend({template:window.TPL["system-row"],tagName:"div",className:"container-fluid system-row",events:{"click button.edit":"clickEditButton"},_editView:!1,clickEditButton:function(){if(this._editView)this._editView.close(),this._editView=null,console.log("Close edit form");else{console.log("Open edit form"),this._editView=new d.SystemEdit({model:this.model}),this._editView.render(),this.$el.after(this._editView.$el),this._openEdit=!1;var a=this;a.listenTo(this._editView,"done",function(){a.stopListening(this._editView),a._editView.close(),a._editView=null,a.render(),console.log("Close edit form, it is done")})}}}),d.SystemList=Marionette.CollectionView.extend({tagName:"div",className:"container-fluid",itemView:d.SystemRow}),d.SystemEdit=Marionette.ItemView.extend({tagName:"div",className:"container-fluid well system-edit-container",template:window.TPL["system-edit"],events:{"submit .form-edit-system":"formSave"},formSave:function(a){a.preventDefault(),console.log("Save button was clicked!");var b=this.$el.find("form").serializeArray();b=_.reduce(b,function(a,b){return a[b.name]=b.value,a},{}),this.model.set("name",b.name),this.model.set("release",b.release),this.model.set("comments",b.comments),b.new_company?this.model.set("company",b.new_company):this.model.set("company",b.company),this.model.save(),this.trigger("done"),this.$el.slideUp(500)}})});